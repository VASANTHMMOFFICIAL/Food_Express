<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Shopping Cart - FoodExpress India</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
    <style>
        /* Custom styles for Indian cart page */
        :root {
            --indian-red: #E53E3E;
            --indian-orange: #DD6B20;
            --indian-green: #38A169;
            --indian-saffron: #F6AD55;
            --indian-blue: #3182CE;
        }
        
        .cart-badge {
            background: linear-gradient(135deg, #FF9933, #FF6633);
            color: white;
        }
        
        .cart-header {
            background: linear-gradient(135deg, #FF9933 0%, #138808 100%);
            color: white;
            border-radius: 10px 10px 0 0;
        }
        
        .indian-flag-colors {
            background: linear-gradient(to right, #FF9933 33%, white 33%, white 66%, #138808 66%);
            height: 4px;
            border-radius: 2px;
        }
        
        .product-tag {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 3px;
            margin-right: 5px;
        }
        
        .veg-tag {
            background-color: var(--indian-green);
            color: white;
        }
        
        .nonveg-tag {
            background-color: var(--indian-red);
            color: white;
        }
        
        .indian-payment-method {
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            height: 100%;
        }
        
        .indian-payment-method:hover {
            border-color: var(--indian-orange);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(221, 107, 32, 0.1);
        }
        
        .indian-payment-method.active {
            border-color: var(--indian-orange);
            background-color: rgba(221, 107, 32, 0.05);
        }
        
        .upi-apps {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .upi-app {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }
        
        .gpay { background-color: #4285F4; }
        .phonepe { background-color: #5F259F; }
        .paytm { background-color: #203C8C; }
        .amazonpay { background-color: #FF9900; }
        .bhim { background-color: #00A1E0; }
        
        .coupon-card {
            background: linear-gradient(135deg, #FFE0B2, #FFCC80);
            border: none;
            border-left: 4px solid var(--indian-orange);
        }
        
        .delivery-info {
            background-color: #E6F3FF;
            border-left: 4px solid var(--indian-blue);
        }
        
        .savings-badge {
            background-color: var(--indian-green);
            color: white;
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 4px;
        }
        
        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .qty-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid #ddd;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .qty-input {
            width: 50px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 5px;
        }
        
        .empty-cart-state {
            text-align: center;
            padding: 3rem 0;
        }
        
        .empty-cart-icon {
            font-size: 4rem;
            color: #ddd;
            margin-bottom: 1rem;
        }
        
        .express-delivery {
            color: var(--indian-green);
            font-weight: 600;
        }
        
        @media (max-width: 768px) {
            .cart-item {
                border-bottom: 1px solid #eee;
                padding-bottom: 1rem;
                margin-bottom: 1rem;
            }
            
            .cart-item:last-child {
                border-bottom: none;
            }
        }
    </style>
</head>
<body>
    <!-- Navbar will be loaded dynamically -->
    <div id="navbar-container"></div>

    <!-- Cart Header -->
    <div class="container py-4">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="index.html">Home</a></li>
                <li class="breadcrumb-item"><a href="food.html">Shop</a></li>
                <li class="breadcrumb-item active" aria-current="page">Shopping Cart</li>
            </ol>
        </nav>
        
        <h1 class="mb-4">Your Shopping Cart</h1>
        
        <!-- Delivery Info Banner -->
        <div class="alert delivery-info d-flex align-items-center mb-4">
            <i class="fas fa-shipping-fast fa-2x me-3 text-primary"></i>
            <div>
                <h5 class="mb-1">Express Delivery Available!</h5>
                <p class="mb-0">Order within <span class="express-delivery">2 hours 15 minutes</span> for delivery today. Minimum order ₹199 for free delivery.</p>
            </div>
        </div>
    </div>

    <!-- Main Cart Content -->
    <div class="container py-4">
        <div class="row">
            <!-- Cart Items -->
            <div class="col-lg-8 mb-4">
                <div class="card shadow-sm mb-4">
                    <div class="card-header cart-header">
                        <div class="d-flex justify-content-between align-items-center">
                            <h4 class="mb-0">Cart Items (<span id="item-count">0</span>)</h4>
                            <span class="badge cart-badge fs-6" id="total-items">0 items</span>
                        </div>
                    </div>
                    <div class="indian-flag-colors"></div>
                    
                    <div class="card-body" id="cart-items-container">
                        <!-- Cart items will be loaded via JavaScript -->
                        <div class="empty-cart-state" id="empty-cart">
                            <i class="fas fa-shopping-cart empty-cart-icon"></i>
                            <h3 class="mb-3">Your cart is empty</h3>
                            <p class="text-muted mb-4">Add some delicious items to get started!</p>
                            <a href="food.html" class="btn btn-primary btn-lg">
                                <i class="fas fa-utensils me-2"></i>Start Shopping
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Coupon Section -->
                <div class="card shadow-sm mb-4">
                    <div class="card-body">
                        <h5 class="mb-3"><i class="fas fa-tag me-2 text-warning"></i>Apply Coupons & Offers</h5>
                        
                        <div class="coupon-card card mb-3">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">FIRST50</h6>
                                        <p class="small text-muted mb-0">Get 15% off on your first order</p>
                                    </div>
                                    <button class="btn btn-sm btn-outline-warning apply-coupon" data-code="FIRST50">
                                        Apply
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="coupon-card card mb-3">
                            <div class="card-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <h6 class="mb-1">FREEDEL</h6>
                                        <p class="small text-muted mb-0">Free delivery on orders above ₹499</p>
                                    </div>
                                    <button class="btn btn-sm btn-outline-warning apply-coupon" data-code="FREEDEL">
                                        Apply
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="input-group">
                            <input type="text" class="form-control" placeholder="Enter coupon code" id="coupon-input">
                            <button class="btn btn-warning" type="button" id="apply-coupon-btn">Apply</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Order Summary -->
            <div class="col-lg-4">
                <div class="card shadow-sm sticky-top" style="top: 20px;">
                    <div class="card-header bg-light">
                        <h4 class="mb-0">Order Summary</h4>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <div class="d-flex justify-content-between mb-2">
                                <span>Subtotal</span>
                                <span id="subtotal">₹0.00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>Delivery Charges</span>
                                <span id="delivery-charge">₹49.00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span>GST (5%)</span>
                                <span id="gst">₹0.00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2 text-success">
                                <span>Discount Applied</span>
                                <span id="discount">-₹0.00</span>
                            </div>
                            <hr>
                            <div class="d-flex justify-content-between mb-3 fw-bold fs-5">
                                <span>Total Amount</span>
                                <span id="total-amount">₹0.00</span>
                            </div>
                            
                            <div class="alert alert-success mb-3" id="savings-message" style="display: none;">
                                <i class="fas fa-rupee-sign me-2"></i>
                                You save <span id="savings-amount">₹0.00</span> on this order!
                            </div>
                        </div>

                        <!-- Delivery Time -->
                        <div class="mb-4">
                            <h6 class="mb-2"><i class="fas fa-clock me-2"></i>Select Delivery Time</h6>
                            <div class="btn-group w-100" role="group">
                                <input type="radio" class="btn-check" name="delivery-time" id="delivery-soon" autocomplete="off" checked>
                                <label class="btn btn-outline-success" for="delivery-soon">
                                    <i class="fas fa-bolt me-1"></i>Soonest<br>
                                    <small>Today, 2-3 hours</small>
                                </label>
                                
                                <input type="radio" class="btn-check" name="delivery-time" id="delivery-schedule" autocomplete="off">
                                <label class="btn btn-outline-primary" for="delivery-schedule">
                                    <i class="fas fa-calendar me-1"></i>Schedule<br>
                                    <small>Choose time</small>
                                </label>
                            </div>
                        </div>

                        <!-- Payment Methods -->
                        <div class="mb-4">
                            <h6 class="mb-3"><i class="fas fa-credit-card me-2"></i>Payment Options</h6>
                            
                            <div class="row g-2 mb-3">
                                <div class="col-6">
                                    <div class="indian-payment-method active" data-method="upi">
                                        <div class="text-center">
                                            <i class="fas fa-mobile-alt fa-2x mb-2 text-primary"></i>
                                            <p class="small mb-0 fw-bold">UPI</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="indian-payment-method" data-method="card">
                                        <div class="text-center">
                                            <i class="fas fa-credit-card fa-2x mb-2 text-success"></i>
                                            <p class="small mb-0 fw-bold">Card</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="indian-payment-method" data-method="netbanking">
                                        <div class="text-center">
                                            <i class="fas fa-university fa-2x mb-2 text-info"></i>
                                            <p class="small mb-0 fw-bold">Net Banking</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="indian-payment-method" data-method="cod">
                                        <div class="text-center">
                                            <i class="fas fa-money-bill-wave fa-2x mb-2 text-warning"></i>
                                            <p class="small mb-0 fw-bold">Cash on Delivery</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- UPI Apps -->
                            <div class="mb-3" id="upi-apps-section">
                                <p class="small mb-2">Pay with your favorite UPI app:</p>
                                <div class="upi-apps">
                                    <div class="upi-app gpay">
                                        <i class="fab fa-google-pay"></i>
                                    </div>
                                    <div class="upi-app phonepe">
                                        <i class="fas fa-mobile-alt"></i>
                                    </div>
                                    <div class="upi-app paytm">
                                        <i class="fas fa-wallet"></i>
                                    </div>
                                    <div class="upi-app amazonpay">
                                        <i class="fab fa-amazon-pay"></i>
                                    </div>
                                    <div class="upi-app bhim">
                                        <i class="fas fa-qrcode"></i>
                                    </div>
                                </div>
                            </div>

                            <!-- Payment Details (Initially hidden) -->
                            <div id="payment-details" style="display: none;">
                                <div class="mb-3">
                                    <label for="upi-id" class="form-label small">UPI ID</label>
                                    <input type="text" class="form-control" id="upi-id" placeholder="username@upi">
                                </div>
                                <div class="mb-3">
                                    <label for="card-number" class="form-label small">Card Number</label>
                                    <input type="text" class="form-control" id="card-number" placeholder="1234 5678 9012 3456">
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-grid gap-2">
                            <button class="btn btn-primary btn-lg" id="proceed-checkout">
                                <i class="fas fa-lock me-2"></i>Proceed to Checkout
                            </button>
                            <button class="btn btn-outline-primary" id="continue-shopping">
                                <i class="fas fa-shopping-bag me-2"></i>Continue Shopping
                            </button>
                        </div>

                        <!-- Trust Badges -->
                        <div class="mt-4 pt-3 border-top text-center">
                            <div class="row g-2">
                                <div class="col-4">
                                    <div class="text-muted">
                                        <i class="fas fa-shield-alt fa-lg mb-2"></i>
                                        <p class="small mb-0">100% Secure</p>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-muted">
                                        <i class="fas fa-undo fa-lg mb-2"></i>
                                        <p class="small mb-0">Easy Returns</p>
                                    </div>
                                </div>
                                <div class="col-4">
                                    <div class="text-muted">
                                        <i class="fas fa-truck fa-lg mb-2"></i>
                                        <p class="small mb-0">Free Delivery*</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Frequently Bought Together -->
        <div class="mt-5">
            <h4 class="mb-4">Frequently Bought Together</h4>
            <div class="row g-4" id="frequently-bought">
                <div class="col-6 col-md-3">
                    <div class="card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1586201375761-83865001e31c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" 
                                 class="card-img-top" alt="Soy Sauce" style="height: 150px; object-fit: cover;">
                            <span class="product-tag veg-tag">VEG</span>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">Soy Sauce</h6>
                            <p class="card-text small text-muted mb-2">Kikkoman, 200ml</p>
                            <div class="d-flex justify-content-between align-items-center mt-auto">
                                <span class="h6 text-primary mb-0">₹149</span>
                                <button class="btn btn-sm btn-primary add-to-cart"
                                    data-id="501"
                                    data-name="Soy Sauce"
                                    data-price="149"
                                    data-image="https://images.unsplash.com/photo-1586201375761-83865001e31c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1569929238190-869826b1bb05?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" 
                                 class="card-img-top" alt="Flour" style="height: 150px; object-fit: cover;">
                            <span class="product-tag veg-tag">VEG</span>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">Wheat Flour</h6>
                            <p class="card-text small text-muted mb-2">Aashirvaad, 1kg</p>
                            <div class="d-flex justify-content-between align-items-center mt-auto">
                                <span class="h6 text-primary mb-0">₹89</span>
                                <button class="btn btn-sm btn-primary add-to-cart"
                                    data-id="502"
                                    data-name="Wheat Flour"
                                    data-price="89"
                                    data-image="https://images.unsplash.com/photo-1569929238190-869826b1bb05?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1533050487297-09b450131914?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" 
                                 class="card-img-top" alt="Olive Oil" style="height: 150px; object-fit: cover;">
                            <span class="product-tag veg-tag">VEG</span>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">Olive Oil</h6>
                            <p class="card-text small text-muted mb-2">Figaro, 500ml</p>
                            <div class="d-flex justify-content-between align-items-center mt-auto">
                                <span class="h6 text-primary mb-0">₹399</span>
                                <button class="btn btn-sm btn-primary add-to-cart"
                                    data-id="503"
                                    data-name="Olive Oil"
                                    data-price="399"
                                    data-image="https://images.unsplash.com/photo-1533050487297-09b450131914?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-6 col-md-3">
                    <div class="card product-card h-100">
                        <div class="position-relative">
                            <img src="https://images.unsplash.com/photo-1592921870789-04563d55041c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80" 
                                 class="card-img-top" alt="Basmati Rice" style="height: 150px; object-fit: cover;">
                            <span class="product-tag veg-tag">VEG</span>
                        </div>
                        <div class="card-body d-flex flex-column">
                            <h6 class="card-title">Basmati Rice</h6>
                            <p class="card-text small text-muted mb-2">India Gate, 1kg</p>
                            <div class="d-flex justify-content-between align-items-center mt-auto">
                                <span class="h6 text-primary mb-0">₹129</span>
                                <button class="btn btn-sm btn-primary add-to-cart"
                                    data-id="504"
                                    data-name="Basmati Rice"
                                    data-price="129"
                                    data-image="https://images.unsplash.com/photo-1592921870789-04563d55041c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer will be loaded dynamically -->
    <div id="footer-container"></div>

    <!-- Checkout Modal -->
    <div class="modal fade" id="checkoutModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Complete Your Order</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- Checkout form will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
    <script>
        // Cart data for Indian market
        const indianCartItems = [
            {
                id: 101,
                name: "Organic Basmati Rice",
                price: 299,
                comparePrice: 349,
                image: "https://images.unsplash.com/photo-1592921870789-04563d55041c?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                category: "Grains",
                weight: "1kg",
                dietary: ["VEG", "ORGANIC"],
                brand: "India Gate",
                quantity: 2
            },
            {
                id: 102,
                name: "Fortune Sunflower Oil",
                price: 189,
                comparePrice: null,
                image: "https://images.unsplash.com/photo-1533050487297-09b450131914?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                category: "Cooking Oil",
                weight: "1L",
                dietary: ["VEG"],
                brand: "Fortune",
                quantity: 1
            },
            {
                id: 103,
                name: "Maggi Noodles",
                price: 56,
                comparePrice: 60,
                image: "https://images.unsplash.com/photo-1566478989037-eec170784d0b?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                category: "Instant Food",
                weight: "Pack of 4",
                dietary: ["VEG"],
                brand: "Nestle",
                quantity: 3
            },
            {
                id: 104,
                name: "Amul Butter",
                price: 55,
                comparePrice: null,
                image: "https://images.unsplash.com/photo-1589985270826-4b7bb135bc9d?ixlib=rb-4.0.3&auto=format&fit=crop&w=800&q=80",
                category: "Dairy",
                weight: "100g",
                dietary: ["VEG"],
                brand: "Amul",
                quantity: 2
            }
        ];

        // Format Indian currency
        function formatIndianRupees(amount) {
            return '₹' + amount.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, '$&,');
        }

        // Load cart items
        function loadCartItems() {
            const cartContainer = document.getElementById('cart-items-container');
            const emptyCart = document.getElementById('empty-cart');
            const cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
            
            if (cart.length === 0) {
                emptyCart.style.display = 'block';
                cartContainer.innerHTML = '';
                cartContainer.appendChild(emptyCart);
                updateCartSummary(0, 0, 0);
                return;
            }
            
            emptyCart.style.display = 'none';
            
            let subtotal = 0;
            let totalItems = 0;
            
            cartContainer.innerHTML = cart.map(item => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                totalItems += item.quantity;
                
                return `
                    <div class="cart-item row align-items-center">
                        <div class="col-3 col-md-2">
                            <img src="${item.image}" alt="${item.name}" class="img-fluid rounded">
                        </div>
                        <div class="col-9 col-md-4">
                            <h6 class="mb-1">${item.name}</h6>
                            <p class="small text-muted mb-1">${item.brand} • ${item.weight}</p>
                            <div class="d-flex">
                                ${item.dietary.map(tag => `
                                    <span class="product-tag ${tag.toLowerCase() === 'veg' ? 'veg-tag' : 'nonveg-tag'}">
                                        ${tag}
                                    </span>
                                `).join('')}
                            </div>
                        </div>
                        <div class="col-4 col-md-2">
                            <div class="text-primary fw-bold">${formatIndianRupees(item.price)}</div>
                            ${item.comparePrice ? `
                                <div class="small text-muted"><del>${formatIndianRupees(item.comparePrice)}</del></div>
                            ` : ''}
                        </div>
                        <div class="col-4 col-md-2">
                            <div class="quantity-controls">
                                <button class="qty-btn decrease-qty" data-id="${item.id}">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <input type="number" class="qty-input" value="${item.quantity}" min="1" data-id="${item.id}">
                                <button class="qty-btn increase-qty" data-id="${item.id}">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                        <div class="col-4 col-md-2 text-end">
                            <div class="h6 text-primary mb-2">${formatIndianRupees(itemTotal)}</div>
                            <button class="btn btn-link text-danger p-0 remove-item" data-id="${item.id}">
                                <i class="fas fa-trash me-1"></i>Remove
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
            
            document.getElementById('item-count').textContent = cart.length;
            document.getElementById('total-items').textContent = totalItems + ' items';
            updateCartSummary(subtotal, totalItems);
            
            // Add event listeners
            setupCartEventListeners();
        }

        // Update cart summary
        function updateCartSummary(subtotal, totalItems) {
            const deliveryCharge = subtotal >= 199 ? 0 : 49;
            const gst = subtotal * 0.05;
            const discount = 0; // Will be updated when coupon applied
            const total = subtotal + deliveryCharge + gst - discount;
            
            document.getElementById('subtotal').textContent = formatIndianRupees(subtotal);
            document.getElementById('delivery-charge').textContent = deliveryCharge === 0 ? 'FREE' : formatIndianRupees(deliveryCharge);
            document.getElementById('gst').textContent = formatIndianRupees(gst);
            document.getElementById('total-amount').textContent = formatIndianRupees(total);
            
            // Show savings if any
            const savings = cart.reduce((total, item) => {
                if (item.comparePrice) {
                    return total + ((item.comparePrice - item.price) * item.quantity);
                }
                return total;
            }, 0);
            
            if (savings > 0) {
                document.getElementById('savings-message').style.display = 'block';
                document.getElementById('savings-amount').textContent = formatIndianRupees(savings);
            }
        }

        // Setup cart event listeners
        function setupCartEventListeners() {
            // Quantity controls
            document.querySelectorAll('.decrease-qty').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.dataset.id);
                    updateQuantity(itemId, -1);
                });
            });
            
            document.querySelectorAll('.increase-qty').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.dataset.id);
                    updateQuantity(itemId, 1);
                });
            });
            
            document.querySelectorAll('.qty-input').forEach(input => {
                input.addEventListener('change', function() {
                    const itemId = parseInt(this.dataset.id);
                    const quantity = parseInt(this.value);
                    if (quantity > 0) {
                        setQuantity(itemId, quantity);
                    }
                });
            });
            
            // Remove items
            document.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', function() {
                    const itemId = parseInt(this.dataset.id);
                    removeFromCart(itemId);
                });
            });
            
            // Payment method selection
            document.querySelectorAll('.indian-payment-method').forEach(method => {
                method.addEventListener('click', function() {
                    document.querySelectorAll('.indian-payment-method').forEach(m => {
                        m.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    const paymentType = this.dataset.method;
                    showPaymentDetails(paymentType);
                });
            });
            
            // Apply coupon buttons
            document.querySelectorAll('.apply-coupon').forEach(btn => {
                btn.addEventListener('click', function() {
                    const couponCode = this.dataset.code;
                    applyCoupon(couponCode);
                });
            });
            
            document.getElementById('apply-coupon-btn').addEventListener('click', function() {
                const couponCode = document.getElementById('coupon-input').value;
                if (couponCode) {
                    applyCoupon(couponCode);
                }
            });
            
            // Proceed to checkout
            document.getElementById('proceed-checkout').addEventListener('click', function() {
                const cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
                if (cart.length === 0) {
                    alert('Your cart is empty. Add some items before checkout.');
                    return;
                }
                proceedToCheckout();
            });
            
            // Continue shopping
            document.getElementById('continue-shopping').addEventListener('click', function() {
                window.location.href = 'food.html';
            });
        }

        // Update quantity
        function updateQuantity(itemId, change) {
            let cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
            const itemIndex = cart.findIndex(item => item.id === itemId);
            
            if (itemIndex !== -1) {
                cart[itemIndex].quantity += change;
                
                if (cart[itemIndex].quantity <= 0) {
                    cart.splice(itemIndex, 1);
                }
                
                localStorage.setItem('cart', JSON.stringify(cart));
                loadCartItems();
                updateCartCount();
            }
        }

        // Set quantity
        function setQuantity(itemId, quantity) {
            let cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
            const itemIndex = cart.findIndex(item => item.id === itemId);
            
            if (itemIndex !== -1) {
                if (quantity <= 0) {
                    cart.splice(itemIndex, 1);
                } else {
                    cart[itemIndex].quantity = quantity;
                }
                
                localStorage.setItem('cart', JSON.stringify(cart));
                loadCartItems();
                updateCartCount();
            }
        }

        // Remove from cart
        function removeFromCart(itemId) {
            let cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
            cart = cart.filter(item => item.id !== itemId);
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCartItems();
            updateCartCount();
        }

        // Apply coupon
        function applyCoupon(code) {
            // In a real app, this would validate with server
            let discount = 0;
            const cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            
            switch(code.toUpperCase()) {
                case 'FIRST50':
                    discount = Math.min(subtotal * 0.15, 50);
                    break;
                case 'FREEDEL':
                    // This would be handled in delivery charges
                    break;
                default:
                    alert('Invalid coupon code');
                    return;
            }
            
            document.getElementById('discount').textContent = '-' + formatIndianRupees(discount);
            document.getElementById('coupon-input').value = code;
            
            // Update total
            const deliveryCharge = subtotal >= 199 ? 0 : 49;
            const gst = subtotal * 0.05;
            const total = subtotal + deliveryCharge + gst - discount;
            document.getElementById('total-amount').textContent = formatIndianRupees(total);
            
            showNotification(`Coupon ${code} applied successfully!`, 'success');
        }

        // Show payment details based on selected method
        function showPaymentDetails(method) {
            const paymentDetails = document.getElementById('payment-details');
            const upiApps = document.getElementById('upi-apps-section');
            
            paymentDetails.style.display = 'none';
            upiApps.style.display = 'block';
            
            if (method === 'upi') {
                upiApps.style.display = 'block';
            } else if (method === 'card') {
                paymentDetails.style.display = 'block';
                paymentDetails.innerHTML = `
                    <div class="mb-3">
                        <label for="card-number" class="form-label small">Card Number</label>
                        <input type="text" class="form-control" id="card-number" placeholder="1234 5678 9012 3456">
                    </div>
                    <div class="row g-2">
                        <div class="col-6">
                            <label for="expiry-date" class="form-label small">Expiry Date</label>
                            <input type="text" class="form-control" id="expiry-date" placeholder="MM/YY">
                        </div>
                        <div class="col-6">
                            <label for="cvv" class="form-label small">CVV</label>
                            <input type="text" class="form-control" id="cvv" placeholder="123">
                        </div>
                    </div>
                `;
            } else if (method === 'netbanking') {
                paymentDetails.style.display = 'block';
                paymentDetails.innerHTML = `
                    <div class="mb-3">
                        <label for="bank" class="form-label small">Select Bank</label>
                        <select class="form-select" id="bank">
                            <option value="">Choose your bank</option>
                            <option value="sbi">State Bank of India</option>
                            <option value="hdfc">HDFC Bank</option>
                            <option value="icici">ICICI Bank</option>
                            <option value="axis">Axis Bank</option>
                            <option value="kotak">Kotak Mahindra Bank</option>
                        </select>
                    </div>
                `;
            }
        }

        // Proceed to checkout
        function proceedToCheckout() {
            const selectedPayment = document.querySelector('.indian-payment-method.active').dataset.method;
            
            if (selectedPayment === 'cod') {
                // For Cash on Delivery, show address form
                showAddressForm();
            } else {
                // For online payments, redirect to payment gateway
                showPaymentGateway();
            }
        }

        // Show address form
        function showAddressForm() {
            const modal = new bootstrap.Modal(document.getElementById('checkoutModal'));
            const modalBody = document.querySelector('#checkoutModal .modal-body');
            
            modalBody.innerHTML = `
                <h5 class="mb-4">Delivery Address</h5>
                <form id="address-form">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="full-name" class="form-label">Full Name</label>
                            <input type="text" class="form-control" id="full-name" required>
                        </div>
                        <div class="col-md-6">
                            <label for="phone" class="form-label">Phone Number</label>
                            <input type="tel" class="form-control" id="phone" required>
                        </div>
                        <div class="col-12">
                            <label for="address" class="form-label">Complete Address</label>
                            <textarea class="form-control" id="address" rows="3" required></textarea>
                        </div>
                        <div class="col-md-4">
                            <label for="pincode" class="form-label">PIN Code</label>
                            <input type="text" class="form-control" id="pincode" required>
                        </div>
                        <div class="col-md-4">
                            <label for="city" class="form-label">City</label>
                            <input type="text" class="form-control" id="city" required>
                        </div>
                        <div class="col-md-4">
                            <label for="state" class="form-label">State</label>
                            <select class="form-select" id="state" required>
                                <option value="">Select State</option>
                                <option value="delhi">Delhi</option>
                                <option value="mumbai">Maharashtra</option>
                                <option value="karnataka">Karnataka</option>
                                <option value="tamilnadu">Tamil Nadu</option>
                                <option value="westbengal">West Bengal</option>
                            </select>
                        </div>
                        <div class="col-12">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="save-address">
                                <label class="form-check-label" for="save-address">
                                    Save this address for future orders
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 pt-3 border-top">
                        <h6 class="mb-3">Order Summary</h6>
                        <div class="d-flex justify-content-between mb-2">
                            <span>Payment Method</span>
                            <span class="fw-bold">Cash on Delivery</span>
                        </div>
                        <div class="alert alert-warning">
                            <i class="fas fa-info-circle me-2"></i>
                            Please keep exact change ready for the delivery person.
                        </div>
                    </div>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-primary btn-lg">
                            Place Order
                        </button>
                    </div>
                </form>
            `;
            
            modal.show();
            
            // Handle form submission
            document.getElementById('address-form').addEventListener('submit', function(e) {
                e.preventDefault();
                placeOrder();
            });
        }

        // Show payment gateway
        function showPaymentGateway() {
            const cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const deliveryCharge = subtotal >= 199 ? 0 : 49;
            const gst = subtotal * 0.05;
            const total = subtotal + deliveryCharge + gst;
            
            const modal = new bootstrap.Modal(document.getElementById('checkoutModal'));
            const modalBody = document.querySelector('#checkoutModal .modal-body');
            
            modalBody.innerHTML = `
                <div class="text-center">
                    <i class="fas fa-lock fa-4x text-primary mb-4"></i>
                    <h4 class="mb-3">Secure Payment</h4>
                    <p class="text-muted mb-4">You will be redirected to a secure payment gateway</p>
                    
                    <div class="card bg-light mb-4">
                        <div class="card-body">
                            <h5 class="mb-3">Payment Amount</h5>
                            <div class="display-4 text-primary fw-bold">${formatIndianRupees(total)}</div>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="fas fa-shield-alt me-2"></i>
                        Your payment information is secure and encrypted.
                    </div>
                    
                    <div class="d-grid gap-2 mt-4">
                        <button class="btn btn-primary btn-lg" id="confirm-payment">
                            <i class="fas fa-lock me-2"></i>Proceed to Payment
                        </button>
                        <button class="btn btn-outline-secondary" data-bs-dismiss="modal">
                            Cancel
                        </button>
                    </div>
                </div>
            `;
            
            modal.show();
            
            document.getElementById('confirm-payment').addEventListener('click', function() {
                processPayment();
            });
        }

        // Place order
        function placeOrder() {
            const cart = JSON.parse(localStorage.getItem('cart')) || indianCartItems;
            
            if (cart.length === 0) {
                alert('Your cart is empty.');
                return;
            }
            
            // Show success message
            showNotification('Order placed successfully! Your order will be delivered soon.', 'success');
            
            // Clear cart
            localStorage.removeItem('cart');
            
            // Close modal
            bootstrap.Modal.getInstance(document.getElementById('checkoutModal')).hide();
            
            // Redirect to order confirmation
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 2000);
        }

        // Process payment
        function processPayment() {
            // Simulate payment processing
            showNotification('Processing payment...', 'info');
            
            setTimeout(() => {
                showNotification('Payment successful! Your order has been confirmed.', 'success');
                
                // Clear cart
                localStorage.removeItem('cart');
                
                // Close modal
                bootstrap.Modal.getInstance(document.getElementById('checkoutModal')).hide();
                
                // Redirect to order confirmation
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 2000);
            }, 3000);
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const alertClass = {
                'success': 'alert-success',
                'error': 'alert-danger',
                'info': 'alert-info',
                'warning': 'alert-warning'
            }[type] || 'alert-info';
            
            const notification = document.createElement('div');
            notification.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
            notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; max-width: 300px;';
            
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'} me-2"></i>
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }

        // Initialize cart page
        document.addEventListener('DOMContentLoaded', function() {
            loadNavbar();
            loadFooter();
            updateCartCount();
            loadCartItems();
            setupCartEventListeners();
            
            // Set initial payment method
            showPaymentDetails('upi');
        });
    </script>
</body>
</html>